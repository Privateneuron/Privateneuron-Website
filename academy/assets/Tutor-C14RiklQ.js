import{j as e}from"./state-DF3Lb9FH.js";import{b as s}from"./react-BdkzLz8Q.js";import{r as v,a as N}from"./katex.min-BmzFcbEa.js";import{u as y,S as $,e as S}from"./index-DS4I3RWH.js";import{L as T}from"./loader-circle-DcuV6ozr.js";import{M as C,r as L,a as E}from"./markdown-CmISyzGm.js";const q=()=>{const{selectedExam:u}=y(),[d,b]=s.useState(""),[n,h]=s.useState(""),[p,k]=s.useState("5"),[i,f]=s.useState("mathematics"),[l,c]=s.useState(!1),[m,x]=s.useState(""),[g,o]=s.useState(""),j=a=>{if(!a)return"";let t=a.replace(/\\\\/g,"\\").replace(/\\\$/g,"$");return t=t.replace(/\${2,}/g,"$"),t=t.replace(/\\frac\{[^{}]+\}\{[^{}]+\}/g,r=>`$${r}$`),t=t.replace(/\\sqrt\{[^{}]+\}/g,r=>`$${r}$`),t=t.replace(/\\(?:pi|theta|alpha|beta|gamma|delta|sigma|pm|times|div)(?![a-zA-Z])/g,r=>`$${r}$`),t=t.replace(/\${2,}/g,"$"),t},w=async()=>{const a=d.trim();if(a.length<2){o("Please enter a topic first.");return}c(!0),o(""),x("");try{const t=await S.post("/learning/tutor",{topic:a,grade_level:Number(p),subject:i,exam_standard:u||"ncdpi",learner_note:n.trim()||void 0});x(String(t.data?.lesson||"No lesson generated."))}catch(t){const r=t?.response?.data?.detail;o(typeof r=="string"&&r?r:"Could not generate tutor lesson.")}finally{c(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 dark:text-slate-100",children:"AI Tutor"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Type a topic and get a guided lesson with practice."})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-3xl p-6 sm:p-8 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsx("input",{value:p,onChange:a=>k(a.target.value),placeholder:"Grade",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),e.jsx("input",{value:i,onChange:a=>f(a.target.value),placeholder:"Subject",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),e.jsx("input",{value:d,onChange:a=>b(a.target.value),placeholder:"Topic (e.g., perimeter and area)",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"})]}),e.jsx("textarea",{value:n,onChange:a=>h(a.target.value),placeholder:"Optional: add what the learner is struggling with.",rows:3,className:"w-full bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),e.jsxs("button",{type:"button",onClick:()=>{w()},disabled:l,className:"w-full sm:w-auto px-6 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-semibold disabled:opacity-60 flex items-center justify-center gap-2",children:[l?e.jsx(T,{className:"w-4 h-4 animate-spin"}):e.jsx($,{className:"w-4 h-4"}),l?"Teaching...":"Teach Me"]}),g&&e.jsx("p",{className:"text-rose-600 text-sm font-medium",children:g})]}),m&&e.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-3xl p-6 sm:p-8",children:e.jsx("div",{className:"prose prose-slate dark:prose-invert max-w-none prose-pre:bg-slate-100 dark:prose-pre:bg-slate-800 prose-pre:border prose-pre:border-slate-200 dark:prose-pre:border-slate-700 whitespace-pre-wrap",children:e.jsx(C,{remarkPlugins:[L,E,N],rehypePlugins:[[v,{strict:!1,throwOnError:!1,output:"html"}]],components:{p:({children:a})=>e.jsx("p",{className:"whitespace-pre-wrap",children:a}),li:({children:a})=>e.jsx("li",{className:"whitespace-pre-wrap",children:a})},children:j(m)})})})]})};export{q as default};
