import{j as e}from"./state-DF3Lb9FH.js";import{b as m}from"./react-BdkzLz8Q.js";import{T as D,a as $,u as Q}from"./progressStore-DUW6oPM7.js";import{c as q,u as U,C as Y,b as S,e as b}from"./index-BC_xtz0l.js";import{C as T}from"./circle-check-DTt7bSIE.js";import{B as L,C as H}from"./circle-alert-Dz7zOi3o.js";const z=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],F=q("clock",z);const G=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],w=q("flame",G),J=({concepts:a,overallMastery:c,bestStreak:x,conceptsDueReview:p,standards:o=[]})=>{const r=s=>s>=.8?"Mastered":s>=.6?"Proficient":s>=.4?"Developing":"Learning",n=a.filter(s=>s.current_level>=.8).length,h=a.filter(s=>s.current_level>=.6&&s.current_level<.8).length,d=a.filter(s=>s.current_level>=.4&&s.current_level<.6).length,g=a.filter(s=>s.current_level<.4).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(D,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-wide opacity-90",children:"Overall Mastery"})]}),e.jsxs("div",{className:"text-4xl font-black",children:[Math.round(c*100),"%"]}),e.jsxs("div",{className:"mt-2 text-sm opacity-90",children:[a.length," concepts tracked"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(T,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-wide opacity-90",children:"Mastered"})]}),e.jsx("div",{className:"text-4xl font-black",children:n}),e.jsx("div",{className:"mt-2 text-sm opacity-90",children:"concepts at 80%+"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(w,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-wide opacity-90",children:"Best Streak"})]}),e.jsx("div",{className:"text-4xl font-black",children:x}),e.jsx("div",{className:"mt-2 text-sm opacity-90",children:"consecutive correct"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(L,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm font-bold uppercase tracking-wide opacity-90",children:"Due for Review"})]}),e.jsx("div",{className:"text-4xl font-black",children:p}),e.jsx("div",{className:"mt-2 text-sm opacity-90",children:"concepts to practice"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Mastery Distribution"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32 text-sm font-bold text-slate-700",children:"Mastered (80%+)"}),e.jsx("div",{className:"flex-1 bg-slate-100 rounded-full h-8 overflow-hidden",children:e.jsx("div",{className:"bg-green-500 h-full flex items-center justify-end px-3 transition-all duration-500",style:{width:`${n/a.length*100}%`},children:e.jsx("span",{className:"text-white text-sm font-bold",children:n})})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32 text-sm font-bold text-slate-700",children:"Proficient (60-79%)"}),e.jsx("div",{className:"flex-1 bg-slate-100 rounded-full h-8 overflow-hidden",children:e.jsx("div",{className:"bg-blue-500 h-full flex items-center justify-end px-3 transition-all duration-500",style:{width:`${h/a.length*100}%`},children:e.jsx("span",{className:"text-white text-sm font-bold",children:h})})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32 text-sm font-bold text-slate-700",children:"Developing (40-59%)"}),e.jsx("div",{className:"flex-1 bg-slate-100 rounded-full h-8 overflow-hidden",children:e.jsx("div",{className:"bg-yellow-500 h-full flex items-center justify-end px-3 transition-all duration-500",style:{width:`${d/a.length*100}%`},children:e.jsx("span",{className:"text-white text-sm font-bold",children:d})})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32 text-sm font-bold text-slate-700",children:"Learning (0-39%)"}),e.jsx("div",{className:"flex-1 bg-slate-100 rounded-full h-8 overflow-hidden",children:e.jsx("div",{className:"bg-orange-500 h-full flex items-center justify-end px-3 transition-all duration-500",style:{width:`${g/a.length*100}%`},children:e.jsx("span",{className:"text-white text-sm font-bold",children:g})})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Your Concepts"}),e.jsx("div",{className:"space-y-3",children:a.map(s=>e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-xl border-2 border-slate-100 hover:border-slate-200 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-bold text-slate-900",children:s.name}),s.is_mastered&&e.jsx(T,{className:"w-5 h-5 text-green-600"}),s.needs_review&&e.jsx(H,{className:"w-5 h-5 text-orange-600"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600",children:[e.jsxs("span",{children:[s.questions_correct," / ",s.questions_attempted," correct"]}),s.streak_current>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-4 h-4 text-orange-500"}),s.streak_current," streak"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-2xl font-black ${s.current_level>=.8?"text-green-600":s.current_level>=.6?"text-blue-600":s.current_level>=.4?"text-yellow-600":"text-orange-600"}`,children:[Math.round(s.current_level*100),"%"]}),e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase",children:r(s.current_level)})]})]},s.concept_id))})]}),o.length>0&&e.jsxs("div",{className:"bg-white rounded-2xl border-2 border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 mb-4",children:"Standard-Level Mastery"}),e.jsx("div",{className:"space-y-3",children:o.slice(0,8).map(s=>e.jsxs("div",{className:"border border-slate-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-bold text-slate-900 uppercase text-sm",children:s.standard_id}),e.jsxs("p",{className:"text-sm font-black text-indigo-600",children:[Math.round(s.mastery),"%"]})]}),e.jsx("div",{className:"h-2 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-500",style:{width:`${Math.max(0,Math.min(100,s.mastery))}%`}})}),e.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Accuracy ",Math.round(s.accuracy),"% â€¢ Questions ",s.questions_attempted," â€¢ Concepts ",s.concepts_tracked]})]},s.standard_id))})]})]})},K=({conceptsDue:a,newConcept:c,goalQuestions:x,estimatedMinutes:p})=>{const o=r=>{const n=new Date(r),d=new Date().getTime()-n.getTime();return Math.floor(d/864e5)};return e.jsxs("div",{className:"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl border-2 border-indigo-200 p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900",children:"ðŸ“… Today's Learning Plan"}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(F,{className:"w-5 h-5"}),e.jsxs("span",{className:"font-bold",children:["~",p," min"]})]})]}),a.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-5 border-2 border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-orange-100 flex items-center justify-center",children:e.jsx($,{className:"w-5 h-5 text-orange-600"})}),e.jsx("h3",{className:"font-bold text-slate-900",children:"ðŸ”„ Due for Review (keep your knowledge fresh!)"})]}),e.jsx("div",{className:"space-y-2",children:a.map(r=>e.jsx("div",{className:"flex items-center justify-between p-3 rounded-lg bg-orange-50 border border-orange-100",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-900",children:r.name}),e.jsxs("div",{className:"text-sm text-slate-600",children:[r.questions_to_review," questions â€¢ Last seen: ",o(r.last_practiced)," days ago"]})]})},r.concept_id))})]}),c&&e.jsxs("div",{className:"bg-white rounded-xl p-5 border-2 border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(L,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-slate-900",children:"ðŸ“š Continue Learning"})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-blue-50 border border-blue-100",children:[e.jsx("div",{className:"font-bold text-slate-900 mb-1",children:c.name}),e.jsx("div",{className:"text-sm text-slate-600 mb-3",children:c.description}),e.jsx("div",{className:"text-xs text-blue-700 font-bold uppercase",children:"Next lesson"})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl p-5 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold uppercase tracking-wide opacity-90 mb-1",children:"Your Goal Today"}),e.jsxs("div",{className:"text-3xl font-black",children:[x," questions"]})]}),e.jsx("button",{className:"px-6 py-3 bg-white text-indigo-600 rounded-xl font-bold hover:bg-indigo-50 transition-colors",children:"Start Today's Session"})]})})]})},C=a=>a.replace(/_/g," ").replace(/\b\w/g,c=>c.toUpperCase()),ae=()=>{const{streak:a,totalQuestionsSolved:c,subjectMastery:x,recentTestIds:p,recentTestIdsByTrack:o}=Q(),r=U(t=>t.selectedExam)||"ncdpi",[n,h]=m.useState(r),[d,g]=m.useState(null),[s,R]=m.useState(null),[A,k]=m.useState([]),[f,_]=m.useState(!1);m.useEffect(()=>{h(r)},[r]);const E=m.useMemo(()=>{const t=new Set([r]);return x.forEach(i=>t.add(String(i.examTrack||"ncdpi"))),Array.from(t)},[r,x]),j=x.filter(t=>String(t.examTrack||"ncdpi")===n),M=o&&Object.keys(o).length>0?Array.isArray(o[n])?o[n]:[]:p,u=M[M.length-1],v=j.reduce((t,i)=>t+i.testsCompleted,0),P=x.reduce((t,i)=>t+i.testsCompleted,0),I=v>0?Math.round(j.reduce((t,i)=>t+i.mastery*i.testsCompleted,0)/v):0;return m.useEffect(()=>{if(!u)return;_(!0),(async()=>{try{const[i,N,B]=await Promise.all([b.get(`/learning/mastery/summary/${u}`),b.get(`/learning/mastery/records/${u}`),b.get(`/learning/mastery/due-for-review/${u}`)]);try{const l=await b.get(`/learning/mastery/standards/${u}`);k(Array.isArray(l.data?.standards)?l.data.standards:[])}catch{k([])}const y=i.data,O=N.data.records||[];g({concepts:O.map(l=>({concept_id:l.concept_id,name:C(l.concept_id),current_level:l.current_level,questions_attempted:l.questions_attempted,questions_correct:l.questions_correct,streak_current:l.streak_current,is_mastered:l.is_mastered,needs_review:l.needs_review})),overallMastery:y.overall_mastery||0,bestStreak:y.best_streak||0,conceptsDueReview:y.concepts_due_review||0}),R({concepts_due:(B.data.concepts_due||[]).map(l=>({concept_id:l.concept_id,name:C(l.concept_id),last_practiced:l.last_practiced||new Date().toISOString(),questions_to_review:l.questions_to_review||3}))})}catch{}finally{_(!1)}})()},[u,n]),P===0?e.jsxs("div",{className:"max-w-3xl mx-auto py-20 text-center space-y-6 animate-in fade-in duration-500",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-indigo-50 border border-indigo-100",children:e.jsx(Y,{className:"w-12 h-12 text-indigo-400"})}),e.jsx("h1",{className:"text-3xl font-black text-slate-900",children:"No progress yet"}),e.jsx("p",{className:"text-slate-500 text-lg font-medium",children:"Complete your first test to start tracking concept mastery and learning progress."})]}):e.jsxs("div",{className:"max-w-5xl mx-auto space-y-10 py-4 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-black text-slate-900 tracking-tight",children:"Learning Progress"}),e.jsx("p",{className:"text-slate-500 font-medium",children:"Your cumulative performance and concept mastery"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(t=>{const i=S(t)?.name||t.toUpperCase(),N=t===n;return e.jsx("button",{type:"button",onClick:()=>h(t),className:`px-3 py-1.5 rounded-lg border text-xs font-bold transition-all ${N?"bg-indigo-600 border-indigo-600 text-white":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"}`,children:i},t)})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center shadow-sm",children:[e.jsx("div",{className:"text-3xl font-black text-slate-900",children:v}),e.jsx("div",{className:"text-xs font-black text-slate-400 uppercase tracking-widest mt-1",children:"Tests Taken"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center shadow-sm",children:[e.jsx("div",{className:"text-3xl font-black text-slate-900",children:c}),e.jsx("div",{className:"text-xs font-black text-slate-400 uppercase tracking-widest mt-1",children:"Questions Solved"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center shadow-sm",children:[e.jsxs("div",{className:"text-3xl font-black text-slate-900",children:[I,"%"]}),e.jsx("div",{className:"text-xs font-black text-slate-400 uppercase tracking-widest mt-1",children:"Avg Score"})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-6 text-center shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(w,{className:"w-6 h-6 text-orange-500"}),e.jsx("span",{className:"text-3xl font-black text-slate-900",children:a})]}),e.jsx("div",{className:"text-xs font-black text-slate-400 uppercase tracking-widest mt-1",children:"Day Streak"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-8 shadow-sm space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"w-6 h-6 text-indigo-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Subject Mastery"}),e.jsx("span",{className:"text-xs text-slate-500 font-semibold",children:S(n)?.name||n.toUpperCase()})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:j.map(t=>e.jsxs("div",{className:"p-5 bg-slate-50 rounded-xl border border-slate-100 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-bold text-slate-700 capitalize",children:t.subject.replace("_"," ")}),e.jsxs("span",{className:"text-sm font-black text-slate-500",children:[t.testsCompleted," test",t.testsCompleted!==1?"s":""]})]}),e.jsx("div",{className:"h-3 w-full bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-indigo-600 rounded-full transition-all duration-700",style:{width:`${t.mastery}%`}})}),e.jsxs("div",{className:"text-right text-sm font-black text-indigo-600",children:[t.mastery,"%"]})]},`${t.examTrack||"ncdpi"}-${t.subject}`))})]}),f&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"})}),!f&&d&&d.concepts.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 px-1",children:[e.jsx($,{className:"w-6 h-6 text-indigo-600"}),e.jsx("h2",{className:"text-xl font-black text-slate-900",children:"Concept Mastery"}),e.jsx("span",{className:"text-sm text-slate-400 font-medium",children:"(from most recent test)"})]}),e.jsx(J,{concepts:d.concepts,overallMastery:d.overallMastery,bestStreak:d.bestStreak,conceptsDueReview:d.conceptsDueReview,standards:A})]}),!f&&s&&s.concepts_due.length>0&&e.jsx(K,{conceptsDue:s.concepts_due,goalQuestions:s.concepts_due.length*3,estimatedMinutes:Math.ceil(s.concepts_due.length*1.5)})]})};export{ae as default};
