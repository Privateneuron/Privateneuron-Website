import{j as a}from"./state-DF3Lb9FH.js";import{b as s}from"./react-BdkzLz8Q.js";import{r as w,a as N}from"./katex.min-BmzFcbEa.js";import{u as $,S as y,e as S}from"./index-2SHsmWnp.js";import{L as T}from"./loader-circle-BcjQrlzb.js";import{M as C,r as L,a as E}from"./markdown-CmISyzGm.js";const q=()=>{const{selectedExam:u}=$(),[d,b]=s.useState(""),[p,h]=s.useState(""),[n,k]=s.useState("5"),[c,f]=s.useState("mathematics"),[l,i]=s.useState(!1),[m,g]=s.useState(""),[x,o]=s.useState(""),j=t=>{if(!t)return"";let e=t.replace(/\\\\/g,"\\").replace(/\\\$/g,"$");return e=e.replace(/\${2,}/g,"$"),e=e.replace(/(\d+(?:\.\d+)?)\s*(\\(?:times|div|pm))\s*(\d+(?:\.\d+)?)/g,"$$$1 $2 $3$$"),e=e.replace(/\\frac\{[^{}]+\}\{[^{}]+\}/g,r=>`$${r}$`),e=e.replace(/\\sqrt\{[^{}]+\}/g,r=>`$${r}$`),e=e.replace(/\\(?:pi|theta|alpha|beta|gamma|delta|sigma|pm|times|div)(?![a-zA-Z])/g,r=>`$${r}$`),e=e.replace(/\${2,}/g,"$"),e=e.replace(/\\times/g,"×").replace(/\\div/g,"÷").replace(/\\pm/g,"±").replace(/\\cdot/g,"·").replace(/\\\(/g,"(").replace(/\\\)/g,")"),e},v=async()=>{const t=d.trim();if(t.length<2){o("Please enter a topic first.");return}i(!0),o(""),g("");try{const e=await S.post("/learning/tutor",{topic:t,grade_level:Number(n),subject:c,exam_standard:u||"ncdpi",learner_note:p.trim()||void 0});g(String(e.data?.lesson||"No lesson generated."))}catch(e){const r=e?.response?.data?.detail;o(typeof r=="string"&&r?r:"Could not generate tutor lesson.")}finally{i(!1)}};return a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 dark:text-slate-100",children:"AI Tutor"}),a.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Type a topic and get a guided lesson with practice."})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-3xl p-6 sm:p-8 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsx("input",{value:n,onChange:t=>k(t.target.value),placeholder:"Grade",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),a.jsx("input",{value:c,onChange:t=>f(t.target.value),placeholder:"Subject",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),a.jsx("input",{value:d,onChange:t=>b(t.target.value),placeholder:"Topic (e.g., perimeter and area)",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"})]}),a.jsx("textarea",{value:p,onChange:t=>h(t.target.value),placeholder:"Optional: add what the learner is struggling with.",rows:3,className:"w-full bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),a.jsxs("button",{type:"button",onClick:()=>{v()},disabled:l,className:"w-full sm:w-auto px-6 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-semibold disabled:opacity-60 flex items-center justify-center gap-2",children:[l?a.jsx(T,{className:"w-4 h-4 animate-spin"}):a.jsx(y,{className:"w-4 h-4"}),l?"Teaching...":"Teach Me"]}),x&&a.jsx("p",{className:"text-rose-600 text-sm font-medium",children:x})]}),m&&a.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-3xl p-6 sm:p-8",children:a.jsx("div",{className:"prose prose-slate dark:prose-invert max-w-none prose-pre:bg-slate-100 dark:prose-pre:bg-slate-800 prose-pre:border prose-pre:border-slate-200 dark:prose-pre:border-slate-700 whitespace-pre-wrap",children:a.jsx(C,{remarkPlugins:[L,E,N],rehypePlugins:[[w,{strict:!1,throwOnError:!1,output:"html"}]],components:{p:({children:t})=>a.jsx("p",{className:"whitespace-pre-wrap",children:t}),li:({children:t})=>a.jsx("li",{className:"whitespace-pre-wrap",children:t})},children:j(m)})})})]})};export{q as default};
