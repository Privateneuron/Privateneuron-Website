import{j as e}from"./state-DF3Lb9FH.js";import{h as Te,u as Ce,c as Me,b as r}from"./react-BdkzLz8Q.js";import{r as ue,a as he}from"./katex.min-BmzFcbEa.js";import{C as Qe}from"./circle-check-Hzd1pIdV.js";import{C as Ae,L as R}from"./lightbulb-DbPMQEUO.js";import{B as Le,C as xe}from"./circle-alert-BwrpkJf-.js";import{M as pe,r as Re,a as Ie}from"./markdown-CmISyzGm.js";import{c as v,e as L}from"./index-CJV1ec0g.js";import{C as qe}from"./chevron-right-YsDTOmlQ.js";const Ee=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],Fe=v("bookmark",Ee);const He=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Pe=v("chevron-left",He);const Oe=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],Be=v("flag",Oe);const Ue=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ze=v("rotate-ccw",Ue);const De=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Ge=v("send",De);const We=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Ke=v("timer",We),S=({content:l,className:d})=>{const i=(x=>{if(!x)return"";let o=x;return o=o.replace(/([^\$]|^)(\\frac\{.+?\}\{.+?\})/g,"$1$$$2$$"),o=o.replace(/([^\$]|^)(\\sqrt\{.+?\})/g,"$1$$$2$$"),o=o.replace(/([^\$]|^)(\\(?:pi|theta|alpha|beta|gamma|delta|sigma))(\b|[^\$])/g,"$1$$$2$$$3"),o})(l);return e.jsx("div",{className:d,children:e.jsx(pe,{remarkPlugins:[he],rehypePlugins:[[ue,{strict:!1,throwOnError:!1,output:"html"}]],components:{p:({node:x,...o})=>e.jsx("p",{className:"mb-2 last:mb-0",...o})},children:i})})},Ye=({question:l,userAnswer:d,isCorrect:c,showHint:i=!1,onTryAgain:x,onShowHint:o})=>e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsxs("div",{className:`
                p-4 rounded-xl border-2 flex items-start gap-3
                ${c?"bg-green-50 border-green-200":"bg-orange-50 border-orange-200"}
            `,children:[c?e.jsx(Qe,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(Ae,{className:"w-6 h-6 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:`font-bold text-base mb-1 ${c?"text-green-900":"text-orange-900"}`,children:c?"Excellent! You've got this concept.":"Not quite - let's understand why."}),e.jsx("p",{className:`text-sm ${c?"text-green-700":"text-orange-700"}`,children:c?"Your practice is paying off! Keep building mastery.":"This is a common challenge. Here's the key insight..."})]})]}),l.explanation_correct&&e.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Le,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-bold text-blue-900 mb-2",children:["Why ",l.correct_answer," is correct:"]}),e.jsx(S,{content:l.explanation_correct,className:"text-sm text-blue-800 prose prose-sm max-w-none"})]})]})}),!c&&l.explanation_wrong&&l.explanation_wrong[d]&&e.jsx("div",{className:"bg-orange-50 border-2 border-orange-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(xe,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-bold text-orange-900 mb-2",children:["Why ",d," is not correct:"]}),e.jsx(S,{content:l.explanation_wrong[d],className:"text-sm text-orange-800 prose prose-sm max-w-none"})]})]})}),!c&&l.common_misconceptions&&l.common_misconceptions.length>0&&e.jsxs("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-4",children:[e.jsxs("h5",{className:"font-bold text-yellow-900 mb-2 flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5"}),"Common Mistakes to Avoid:"]}),e.jsx("ul",{className:"space-y-1 text-sm text-yellow-800",children:l.common_misconceptions.map((f,a)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-yellow-600 mt-0.5",children:"â€¢"}),e.jsx(S,{content:f})]},a))})]}),l.worked_example&&e.jsxs("div",{className:"bg-slate-50 border-2 border-slate-200 rounded-xl p-4",children:[e.jsx("h5",{className:"font-bold text-slate-900 mb-2",children:"Step-by-Step Solution:"}),e.jsx("div",{className:"text-sm text-slate-800 font-mono bg-white p-3 rounded border border-slate-200 overflow-x-auto",children:e.jsx(S,{content:l.worked_example})})]}),i&&l.hint&&e.jsx("div",{className:"bg-indigo-50 border-2 border-indigo-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(R,{className:"w-5 h-5 text-indigo-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-indigo-900 mb-2",children:"Hint:"}),e.jsx(S,{content:l.hint,className:"text-sm text-indigo-800 prose prose-sm max-w-none"})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[!c&&x&&e.jsx("button",{onClick:x,className:"px-4 py-2 bg-orange-600 text-white rounded-lg font-semibold hover:bg-orange-700 transition-colors",children:"Try Again"}),!i&&l.hint&&o&&e.jsxs("button",{onClick:o,className:"px-4 py-2 bg-indigo-100 text-indigo-700 rounded-lg font-semibold hover:bg-indigo-200 transition-colors flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),"Show Hint"]})]})]}),Je=l=>{if(!l)return"";let d=l.replace(/\\\\/g,"\\");return d=d.replace(/(^|[^\$])(\\frac\{.+?\}\{.+?\})/g,"$1$$$2$$"),d=d.replace(/(^|[^\$])(\\sqrt\{.+?\})/g,"$1$$$2$$"),d=d.replace(/(^|[^\$])(\\(?:pi|theta|alpha|beta|gamma|delta|sigma))(\b|[^\$])/g,"$1$$$2$$$3"),d},Ve=l=>{const d=String(l||"").replace(/\\\\/g,"\\"),c=/\\frac\{([^{}]+)\}\{([^{}]+)\}/g,i=[];let x=0,o,f=0;for(;(o=c.exec(d))!==null;){o.index>x&&i.push(d.slice(x,o.index));const a=o[1],h=o[2];i.push(e.jsxs("span",{className:"inline-flex flex-col items-center align-middle mx-1 leading-none",children:[e.jsx("span",{className:"px-0.5",children:a}),e.jsx("span",{className:"w-full border-t border-current my-0.5"}),e.jsx("span",{className:"px-0.5",children:h})]},`frac-${f++}`)),x=c.lastIndex}return x<d.length&&i.push(d.slice(x)),i.length?i:[d]},Xe=[Re,Ie,he],Ze=r.memo(function({questionsLength:d,answers:c,markedForReview:i,currentQuestionIndex:x,onGoToQuestion:o}){return e.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-10 gap-2",children:Array.from({length:d}).map((f,a)=>{const h=(c[a]||"").trim().length>0,g=i.has(a),y=a===x;let p="border-slate-200 bg-white text-slate-600";return h&&(p="border-emerald-200 bg-emerald-50 text-emerald-700"),g&&(p="border-amber-200 bg-amber-50 text-amber-700"),y&&(p="border-indigo-600 bg-indigo-600 text-white"),e.jsx("button",{type:"button",onClick:()=>o(a),className:`h-10 rounded-xl border font-black text-sm transition-all hover:scale-[1.03] ${p}`,children:a+1},a)})})}),et=r.memo(function({options:d,userAnswer:c,isAnswered:i,practiceMode:x,isCorrect:o,onAnswerChange:f}){return e.jsx("div",{className:"grid grid-cols-1 gap-4",children:Object.entries(d||{}).map(([a,h])=>e.jsxs("button",{onClick:()=>f(a),disabled:i&&x,className:`flex items-start gap-5 p-6 rounded-2xl border-2 transition-all text-left group ${c===a?x?o?"border-emerald-500 bg-emerald-50 dark:border-emerald-400 dark:bg-emerald-900/30":"border-rose-500 bg-rose-50 dark:border-rose-400 dark:bg-rose-900/30":"border-indigo-600 bg-indigo-50 shadow-md dark:border-indigo-400 dark:bg-indigo-900/35":"border-slate-50 bg-slate-50 hover:border-slate-200 hover:bg-white dark:border-slate-700 dark:bg-slate-800 dark:hover:border-slate-600 dark:hover:bg-slate-800/80"}`,children:[e.jsx("div",{className:`w-9 h-9 rounded-xl flex items-center justify-center font-black flex-shrink-0 transition-transform group-hover:scale-105 ${c===a?"bg-indigo-600 text-white":"bg-white text-slate-400 border border-slate-200 shadow-sm"}`,children:a}),e.jsx("span",{className:`flex-1 font-bold text-lg leading-snug pt-1 ${c===a?"text-slate-900 dark:text-slate-100":"text-slate-600 dark:text-slate-200"}`,children:h})]},a))})}),ct=()=>{const{testId:l}=Te(),d=Ce(),c=Me(),i=c.state?.practiceMode||!1,x=c.state?.examTrack||null,[o,f]=r.useState(null),[a,h]=r.useState(0),[g,y]=r.useState({}),[p,D]=r.useState(new Set),[ge,be]=r.useState(!0),[G,W]=r.useState(""),[K,Y]=r.useState(!1),[j,I]=r.useState(900),[w,q]=r.useState(new Set),[k,_]=r.useState(!1),[E,J]=r.useState({}),[F,H]=r.useState(new Set),[fe,we]=r.useState(new Map),[V,X]=r.useState(!1),[T,C]=r.useState(""),[Z,ee]=r.useState(""),[te,P]=r.useState(""),[O,se]=r.useState(!1),[ae,M]=r.useState(""),B=r.useRef(Date.now()),[re,je]=r.useState(!1),ne=r.useRef(!1),N=r.useRef(null),b=r.useMemo(()=>l?`take-test-progress-v1-${l}`:"",[l]),Ne=[{value:"unclear_wording",label:"Unclear wording"},{value:"wrong_answer",label:"Wrong answer"},{value:"too_hard",label:"Too hard"},{value:"off_topic",label:"Off topic"}];r.useEffect(()=>{if(b)try{const t=sessionStorage.getItem(b);if(!t)return;const s=JSON.parse(t);s&&typeof s=="object"&&(s.answers&&typeof s.answers=="object"&&y(s.answers),Number.isInteger(s.currentQuestionIndex)&&Number(s.currentQuestionIndex)>=0&&h(Number(s.currentQuestionIndex)),Array.isArray(s.markedForReview)&&D(new Set(s.markedForReview.map(n=>Number(n)).filter(n=>Number.isInteger(n)&&n>=0))),Array.isArray(s.showHintsByQuestion)&&q(new Set(s.showHintsByQuestion.map(n=>Number(n)).filter(n=>Number.isInteger(n)&&n>=0))),s.questionTimes&&typeof s.questionTimes=="object"&&J(s.questionTimes),Array.isArray(s.hintsUsed)&&H(new Set(s.hintsUsed.map(n=>Number(n)).filter(n=>Number.isInteger(n)&&n>=0))),Number.isFinite(s.timeLeft)&&Number(s.timeLeft)>0&&(I(Number(s.timeLeft)),ne.current=!0))}catch{sessionStorage.removeItem(b)}finally{je(!0)}},[b]),r.useEffect(()=>{(async()=>{try{const s=await L.get(`/tests/${l}`);f(s.data),W("");const n=90,$=s.data?.questions?.length||s.data?.question_count||10;ne.current||I($*n)}catch(s){console.error("Failed to fetch test",s);const n=s?.response?.data?.detail;W(typeof n=="string"&&n.trim()?n:"Failed to load test. Please try again.")}finally{be(!1)}})()},[l]),r.useEffect(()=>{if(j<=0||i)return;const t=setInterval(()=>{I(s=>s-1)},1e3);return()=>clearInterval(t)},[j,i]),r.useEffect(()=>{if(!(!re||!b))return N.current&&window.clearTimeout(N.current),N.current=window.setTimeout(()=>{try{sessionStorage.setItem(b,JSON.stringify({answers:g,currentQuestionIndex:a,markedForReview:Array.from(p),showHintsByQuestion:Array.from(w),questionTimes:E,hintsUsed:Array.from(F),timeLeft:j,updatedAt:Date.now()}))}catch{}},250),()=>{N.current&&(window.clearTimeout(N.current),N.current=null)}},[re,b,g,a,p,w,E,F,j]);const u=o?.questions||[],m=u[a],U=r.useMemo(()=>{const t=String(o?.standard_focus||"").trim();if(t)return t;const s=String(m?.learning_objective||"").trim();return s||String(o?.subject||"Current topic").trim()},[o?.standard_focus,o?.subject,m?.learning_objective]);r.useEffect(()=>{u.length&&a>u.length-1&&h(Math.max(0,u.length-1))},[u.length,a]),r.useEffect(()=>{i&&(T.trim()||C(U))},[i,T,U]);const oe=r.useMemo(()=>Object.values(g).filter(t=>typeof t=="string"&&t.trim().length>0).length,[g]),z=Math.max(0,u.length-oe),le=r.useCallback(t=>{const s=m?.question_type==="mcq"||!!m?.options;k&&i&&s||(y(n=>({...n,[a]:t})),i&&t.trim().length>0&&_(!0))},[m,a,k,i]),ie=t=>{const s=Math.round((Date.now()-B.current)/1e3);J(n=>({...n,[t]:(n[t]||0)+s})),B.current=Date.now()},ve=async t=>{if(X(!1),!!m?.id)try{await L.post(`/tests/${l}/questions/${m.id}/flag`,{reason:t}),we(s=>new Map(s).set(a,t))}catch{}},ye=()=>{D(t=>{const s=new Set(t);return s.has(a)?s.delete(a):s.add(a),s})},de=()=>{y(t=>{const s={...t};return delete s[a],s}),_(!1)},ke=()=>{ie(a),h(t=>Math.min(t+1,u.length-1)),_(!1)},$e=r.useCallback(t=>{ie(a),h(t),_(!1)},[a]),Se=async()=>{if(u.length===0||z>0&&!window.confirm(`You still have ${z} unanswered question(s) and ${p.size} marked for review. Submit anyway?`))return;Y(!0);const t={...E},s=Math.round((Date.now()-B.current)/1e3);t[a]=(t[a]||0)+s;try{const n=await L.post(`/tests/${l}/submit`,g);b&&sessionStorage.removeItem(b),d(`/results/${l}`,{state:{answers:g,ai_feedback:n.data.ai_feedback,submission:n.data,practiceMode:i,examTrack:x,questionTimes:t,hintsUsed:Array.from(F)}})}catch(n){console.error("Submission failed",n)}finally{Y(!1)}},ce=async t=>{const s=String(t||T).trim();if(s.length<2){M("Enter a topic for the tutor.");return}se(!0),M(""),P("");try{const n=await L.post("/learning/tutor",{topic:s,grade_level:Number(o?.grade_level)||void 0,subject:String(o?.subject||"").toLowerCase()||void 0,exam_standard:String(x||o?.exam_standard||"").toLowerCase()||void 0,learner_note:Z.trim()||void 0});P(String(n.data?.lesson||"No tutor content returned."))}catch(n){const $=n?.response?.data?.detail;M(typeof $=="string"&&$.trim()?$:"Tutor request failed.")}finally{se(!1)}};if(ge)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center px-4",children:e.jsxs("div",{className:"bg-white/95 border border-slate-200 rounded-2xl p-6 shadow-lg flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-slate-800 font-semibold",children:"Loading test..."})]})});if(G)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-xl w-full bg-white border border-rose-200 rounded-2xl p-6 shadow-lg",children:[e.jsx("p",{className:"text-sm font-black uppercase tracking-widest text-rose-600",children:"Could not load test"}),e.jsx("p",{className:"mt-2 text-slate-800",children:G})]})});if(!o)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-xl w-full bg-white border border-slate-200 rounded-2xl p-6 shadow-lg",children:[e.jsx("p",{className:"text-sm font-black uppercase tracking-widest text-slate-500",children:"Test unavailable"}),e.jsx("p",{className:"mt-2 text-slate-800",children:"Test not found."})]})});if(!m)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-xl w-full bg-white border border-slate-200 rounded-2xl p-6 shadow-lg",children:[e.jsx("p",{className:"text-sm font-black uppercase tracking-widest text-slate-500",children:"Question unavailable"}),e.jsx("p",{className:"mt-2 text-slate-800",children:"Question not found."})]})});const _e=a===u.length-1,Q=m.question_type==="mcq"||!!m.options,A=g[a]||"",me=Q&&A===m.correct_answer;return e.jsx("div",{className:`${i?"max-w-7xl":"max-w-5xl"} mx-auto py-4`,children:e.jsxs("div",{className:i?"grid grid-cols-1 xl:grid-cols-[minmax(0,1fr)_360px] gap-6":"",children:[e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom duration-400",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-black text-slate-900 tracking-tight",children:o.title}),i&&e.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-600 border border-emerald-100 rounded text-[10px] font-black uppercase tracking-widest",children:"Practice Mode"})]}),e.jsxs("p",{className:"text-slate-500 font-medium",children:["Question ",a+1," of ",u.length]})]}),!i&&e.jsxs("div",{className:"flex items-center gap-3 bg-white px-4 py-2 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsx(Ke,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("span",{className:"text-lg font-black font-mono text-slate-900 tracking-tighter",children:[Math.floor(j/60),":",(j%60).toString().padStart(2,"0")]})]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsx("p",{className:"font-bold text-slate-900",children:"Question Palette"}),e.jsxs("div",{className:"text-xs font-semibold text-slate-500",children:["Answered: ",e.jsx("span",{className:"text-emerald-600",children:oe})," | Remaining: ",e.jsx("span",{className:"text-rose-600",children:z})," | Review: ",e.jsx("span",{className:"text-amber-600",children:p.size})]})]}),e.jsx(Ze,{questionsLength:u.length,answers:g,markedForReview:p,currentQuestionIndex:a,onGoToQuestion:$e})]}),e.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:"h-full bg-indigo-600 transition-all duration-700 ease-out shadow-sm",style:{width:`${(a+1)/u.length*100}%`}})}),e.jsxs("div",{className:"bg-white p-8 sm:p-12 rounded-[2rem] border border-slate-200 shadow-xl shadow-slate-100/50 space-y-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1.5 bg-indigo-600/10"}),e.jsxs("div",{className:"absolute top-6 right-6 flex items-center gap-2",children:[e.jsx("button",{onClick:ye,className:`p-3 rounded-2xl border transition-all ${p.has(a)?"bg-amber-50 text-amber-700 border-amber-200":"bg-white text-slate-500 border-slate-200 hover:bg-slate-50"}`,title:"Mark for review",children:e.jsx(Fe,{className:"w-5 h-5"})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>X(!V),className:`p-3 rounded-2xl border transition-all ${fe.has(a)?"bg-rose-50 text-rose-600 border-rose-200":"bg-white text-slate-500 border-slate-200 hover:bg-slate-50"}`,title:"Flag this question",children:e.jsx(Be,{className:"w-5 h-5"})}),V&&e.jsxs("div",{className:"absolute right-0 top-12 z-50 bg-white border border-slate-200 rounded-2xl shadow-xl p-2 min-w-[180px]",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest px-3 py-1",children:"Why flag?"}),Ne.map(t=>e.jsx("button",{onClick:()=>ve(t.value),className:"w-full text-left px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 rounded-xl transition-colors",children:t.label},t.value))]})]}),e.jsx("button",{onClick:()=>{const t=new Set(w);t.has(a)?t.delete(a):(t.add(a),H(s=>new Set(s).add(a))),q(t)},className:`p-3 rounded-2xl transition-all border ${w.has(a)?"bg-amber-100 text-amber-700 border-amber-300 shadow-md":"bg-amber-50 text-amber-600 hover:bg-amber-100 border-amber-100 shadow-sm"}`,title:"Get a hint",children:e.jsx(R,{className:"w-5 h-5"})}),e.jsx("button",{onClick:de,className:"p-3 rounded-2xl bg-slate-50 text-slate-600 hover:bg-slate-100 transition-all border border-slate-100 shadow-sm",title:"Clear answer",children:e.jsx(ze,{className:"w-5 h-5"})})]}),e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-slate-900 leading-[1.3] tracking-tight pr-24",children:Ve(String(m.question_text||""))}),w.has(a)&&m.hint&&e.jsxs("div",{className:"bg-amber-50 border-l-4 border-amber-400 p-5 rounded-2xl animate-in fade-in zoom-in duration-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(R,{className:"w-4 h-4 text-amber-600"}),e.jsx("span",{className:"text-xs font-black text-amber-700 uppercase",children:"Hint"})]}),e.jsx("p",{className:"text-sm text-slate-700 font-medium italic leading-relaxed",children:m.hint})]}),Q?e.jsx(et,{options:m.options||{},userAnswer:A,isAnswered:k,practiceMode:i,isCorrect:!!me,onAnswerChange:le}):e.jsx("textarea",{value:A,onChange:t=>le(t.target.value),placeholder:"Type your detailed response here...",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-3xl p-8 h-48 outline-none focus:ring-4 focus:ring-indigo-100 focus:border-indigo-600 transition-all font-medium text-lg text-slate-900 placeholder-slate-400"}),i&&k&&Q&&e.jsx(Ye,{question:m,userAnswer:A,isCorrect:me,showHint:w.has(a),onShowHint:()=>{const t=new Set(w);t.add(a),q(t),H(s=>new Set(s).add(a))},onTryAgain:de}),i&&k&&!Q&&e.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-2xl p-6 space-y-3",children:[e.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-indigo-700",children:"Model Guidance"}),e.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:m.correct_answer||"Review the standard and provide a complete evidence-based response."}),m.explanation_correct&&e.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:m.explanation_correct})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 py-4",children:[e.jsxs("button",{onClick:()=>h(t=>Math.max(t-1,0)),disabled:a===0,className:"w-full sm:w-auto px-8 py-4 rounded-2xl bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 disabled:opacity-30 font-bold flex items-center justify-center gap-2 transition-all",children:[e.jsx(Pe,{className:"w-5 h-5"})," Previous"]}),_e?e.jsxs("button",{onClick:Se,disabled:K,className:"w-full sm:w-auto px-10 py-4 rounded-2xl bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50 font-black shadow-xl shadow-indigo-100 flex items-center justify-center gap-3 transition-all hover:scale-[1.02] active:scale-95 text-lg",children:[K?"Submitting Responses...":"Finish Assessment",e.jsx(Ge,{className:"w-5 h-5"})]}):e.jsxs("button",{onClick:ke,className:"w-full sm:w-auto px-12 py-4 rounded-2xl bg-indigo-600 text-white hover:bg-indigo-700 font-black shadow-xl shadow-indigo-100 flex items-center justify-center gap-3 transition-all hover:scale-[1.02] active:scale-95 text-lg",children:["Next Question ",e.jsx(qe,{className:"w-5 h-5"})]})]})]}),i&&e.jsxs("aside",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-5 space-y-4 h-fit xl:sticky xl:top-20",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-slate-700",children:"Practice Tutor"}),e.jsx("button",{type:"button",onClick:()=>{C(U),ee(""),P(""),M("")},className:"text-xs text-slate-500 hover:text-slate-700",children:"Reset"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"Topic"}),e.jsx("input",{value:T,onChange:t=>C(t.target.value),className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-900",placeholder:"Ask about this skill..."}),e.jsx("button",{type:"button",onClick:()=>C(String(m?.question_text||"").trim()),className:"text-xs text-indigo-600 hover:text-indigo-700 font-semibold",children:"Use current question text"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500",children:"What are you stuck on? (optional)"}),e.jsx("textarea",{value:Z,onChange:t=>ee(t.target.value),rows:3,className:"w-full bg-slate-50 border border-slate-200 rounded-xl px-3 py-2 text-sm text-slate-900",placeholder:"Example: I confuse perimeter and area."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{ce()},disabled:O,className:"flex-1 px-3 py-2 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-bold disabled:opacity-60",children:O?"Teaching...":"Teach Topic"}),e.jsx("button",{type:"button",onClick:()=>{ce(String(m?.question_text||"").trim())},disabled:O,className:"flex-1 px-3 py-2 rounded-xl bg-slate-900 hover:bg-black text-white text-sm font-bold disabled:opacity-60",children:"Explain Q"})]}),ae&&e.jsx("p",{className:"text-xs text-rose-600 font-medium",children:ae}),te&&e.jsx("div",{className:"max-h-[60vh] overflow-auto border border-slate-200 rounded-xl p-3 bg-slate-50",children:e.jsx("div",{className:"prose prose-sm max-w-none whitespace-pre-wrap",children:e.jsx(pe,{remarkPlugins:Xe,rehypePlugins:[[ue,{strict:!1,throwOnError:!1,output:"html"}]],components:{p:({children:t})=>e.jsx("p",{className:"whitespace-pre-wrap",children:t}),li:({children:t})=>e.jsx("li",{className:"whitespace-pre-wrap",children:t})},children:Je(te)})})})]})]})})};export{ct as default};
