import{j as a}from"./state-DF3Lb9FH.js";import{b as s}from"./react-BdkzLz8Q.js";import{r as y,a as S}from"./katex.min-BmzFcbEa.js";import{u as C,S as L,e as T}from"./index-B8mKEuVJ.js";import{L as E}from"./loader-circle-CVZQLh4z.js";import{M,r as G,a as _}from"./markdown-CmISyzGm.js";const I=()=>{const{selectedExam:u}=C(),[d,b]=s.useState(""),[c,h]=s.useState(""),[p,f]=s.useState("5"),[n,k]=s.useState("mathematics"),[l,i]=s.useState(!1),[g,m]=s.useState(""),[x,o]=s.useState(""),j=r=>{if(!r)return"";let e=r.replace(/\\\\/g,"\\").replace(/\\\$/g,"$");return e=e.replace(/\${2,}/g,"$"),e=e.replace(/(^|[^\\])frac\{/g,"$1\\frac{"),e=e.replace(/\\frac\s*([^{}\s]+)\}\{([^{}]+)\}/g,"\\frac{$1}{$2}"),e=e.replace(/(\d+(?:\.\d+)?)\s*\\?(times|div|pm)\s*(\d+(?:\.\d+)?)/gi,(t,v,w,N)=>`$${v} \\\\${String(w).toLowerCase()} ${N}$`),e=e.replace(/\\frac\{[^{}]+\}\{[^{}]+\}/g,t=>`$${t}$`),e=e.replace(/\\sqrt\{[^{}]+\}/g,t=>`$${t}$`),e=e.replace(/\\(?:pi|theta|alpha|beta|gamma|delta|sigma|pm|times|div)(?![a-zA-Z])/g,t=>`$${t}$`),e=e.replace(/\${2,}/g,"$"),(e.match(/\$/g)||[]).length%2!==0&&(e=e.replace(/\$/g,"")),e=e.replace(/\\times/g," x ").replace(/\\div/g," / ").replace(/\\pm/g,"+/-").replace(/\\cdot/g," * ").replace(/\\\(/g,"(").replace(/\\\)/g,")"),e},$=async()=>{const r=d.trim();if(r.length<2){o("Please enter a topic first.");return}i(!0),o(""),m("");try{const e=await T.post("/learning/tutor",{topic:r,grade_level:Number(p),subject:n,exam_standard:u||"ncdpi",learner_note:c.trim()||void 0});m(String(e.data?.lesson||"No lesson generated."))}catch(e){const t=e?.response?.data?.detail;o(typeof t=="string"&&t?t:"Could not generate tutor lesson.")}finally{i(!1)}};return a.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 dark:text-slate-100",children:"AI Tutor"}),a.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Type a topic and get a guided lesson with practice."})]}),a.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-3xl p-6 sm:p-8 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[a.jsx("input",{value:p,onChange:r=>f(r.target.value),placeholder:"Grade",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),a.jsx("input",{value:n,onChange:r=>k(r.target.value),placeholder:"Subject",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),a.jsx("input",{value:d,onChange:r=>b(r.target.value),placeholder:"Topic (e.g., perimeter and area)",className:"bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"})]}),a.jsx("textarea",{value:c,onChange:r=>h(r.target.value),placeholder:"Optional: add what the learner is struggling with.",rows:3,className:"w-full bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-3 text-slate-900 dark:text-slate-100"}),a.jsxs("button",{type:"button",onClick:()=>{$()},disabled:l,className:"w-full sm:w-auto px-6 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-700 text-white font-semibold disabled:opacity-60 flex items-center justify-center gap-2",children:[l?a.jsx(E,{className:"w-4 h-4 animate-spin"}):a.jsx(L,{className:"w-4 h-4"}),l?"Teaching...":"Teach Me"]}),x&&a.jsx("p",{className:"text-rose-600 text-sm font-medium",children:x})]}),g&&a.jsx("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-3xl p-6 sm:p-8",children:a.jsx("div",{className:"prose prose-slate dark:prose-invert max-w-none prose-pre:bg-slate-100 dark:prose-pre:bg-slate-800 prose-pre:border prose-pre:border-slate-200 dark:prose-pre:border-slate-700 whitespace-pre-wrap",children:a.jsx(M,{remarkPlugins:[G,_,S],rehypePlugins:[[y,{strict:!1,throwOnError:!1,output:"html"}]],components:{p:({children:r})=>a.jsx("p",{className:"whitespace-pre-wrap",children:r}),li:({children:r})=>a.jsx("li",{className:"whitespace-pre-wrap",children:r})},children:j(g)})})})]})};export{I as default};
